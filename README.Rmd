---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
library(bitfield)
```

# bitfield <a href='https://github.com/bitfloat/bitfield/'><img src='man/figures/logo.svg' align="right" height="200" /></a>

<!-- badges: start -->
[![CRAN\_Status\_Badge](http://www.r-pkg.org/badges/version/bitfield)](https://cran.r-project.org/package=bitfield)
[![](http://cranlogs.r-pkg.org/badges/grand-total/bitfield)](https://cran.r-project.org/package=bitfield)

[![R-CMD-check](https://github.com/bitfloat/bitfield/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/bitfloat/bitfield/actions/workflows/R-CMD-check.yaml)
[![codecov](https://codecov.io/gh/bitfloat/bitfield/graph/badge.svg?token=QZB36RION3)](https://app.codecov.io/gh/bitfloat/bitfield)
[![Lifecycle: stable](https://img.shields.io/badge/lifecycle-stable-brightgreen.svg)](https://lifecycle.r-lib.org/articles/stages.html#stable)
<!-- badges: end -->

## Overview

The `bitfield` package enables efficient storage and transmission of metadata and intermediate results across scientific workflows by encoding computational decisions into sequences of bits that transform to integer values. This approach allows storing rich contextual information - including quality assessments, uncertainty metrics, model parameters, and processing thresholds - in a single column of a table or raster layer.

Think of a bit as a switch representing off and on states. A sequence of n bits can accommodate 2^n states, enabling the encoding of boolean responses, categorical cases, integers, or even floating-point values with limited precision. The resulting bitfield creates a 'computational footprint' that preserves the context needed for cross-workflow integration and downstream reuse.

## Installation

Install the official version from CRAN:

```{r, eval=FALSE}
install.packages("bitfield")
```

Install the latest development version from GitHub:

```{r, eval=FALSE}
devtools::install_github("bitfloat/bitfield")
```

## Getting Started

```{r}
library(bitfield)
library(dplyr, warn.conflicts = FALSE)

# Example data with quality issues
bf_tbl
```

Create a registry to capture metadata about your workflow:

```{r}
reg <- bf_registry(name = "data_quality", 
                   description = "Quality assessment for agricultural data")

# Test for missing values
reg <- bf_map(protocol = "na", data = bf_tbl, x = commodity, registry = reg)

# Encode yield values with limited precision  
reg <- bf_map(protocol = "numeric", data = bf_tbl, x = yield, 
              format = "half", registry = reg)

# View the registry structure
reg
```

Encode the flags into integer representation:

```{r}
(field <- bf_encode(registry = reg))
```

Decode the bitfield in a downstream application:

```{r}
(flags <- bf_decode(x = field, registry = reg, verbose = FALSE))

# -> legend is available in bf_legend

bf_tbl |>
  bind_cols(flags) |>
  knitr::kable()
```

The decoded information is also available in the package environment for programmatic access:

```{r}
# access values manually
ls(.GlobalEnv)

.GlobalEnv[["na_commodity"]]
.GlobalEnv[["numeric_yield"]]

# beware that numeric values are stored with the precision you have specified
bf_tbl$yield
```

## Further Reading

- **[Best Practices](articles/best-practices.html)**: Guidelines for effective bitfield design, protocol selection, and common pitfalls
- **[Community Contributions](articles/community-contributions.html)**: How to contribute protocols to the community standards repository
- **[Applications and Citations](articles/applications.html)**: Papers and projects using the bitfield package

## Getting Help

- Browse the [function reference](reference/index.html) for detailed documentation
- Report bugs at [github.com/bitfloat/bitfield/issues](https://github.com/bitfloat/bitfield/issues)
- Join discussions about community standards at [github.com/bitfloat/standards](https://github.com/bitfloat/standards)
