<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Handle Bitfields to Record Meta Data • bitfield</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Handle Bitfields to Record Meta Data">
<meta property="og:description" content="Record algorithmic and analytic meta data along a workflow to store that in a bitfield, which can be published alongside any (modelled) data products.">
<meta property="og:image" content="http://bitfloat.github.io/bitfield/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">bitfield</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bitfloat/bitfield" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="bitfield-">bitfield <a href="https://github.com/bitfloat/bitfield/" class="external-link"><img src="reference/figures/logo.svg" align="right" height="200"></a>
<a class="anchor" aria-label="anchor" href="#bitfield-"></a>
</h1></div>
<!-- badges: start -->

<p><a href="https://github.com/bitfloat/bitfield/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/bitfloat/bitfield/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a> <a href="https://app.codecov.io/gh/bitfloat/bitfield" class="external-link"><img src="https://codecov.io/gh/bitfloat/bitfield/graph/badge.svg?token=QZB36RION3" alt="codecov"></a> <a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a> <!-- badges: end --></p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <code>bitfield</code> package enables efficient storage and transmission of metadata and intermediate results across scientific workflows by encoding computational decisions into sequences of bits that transform to integer values. This approach allows storing rich contextual information - including quality assessments, uncertainty metrics, model parameters, and processing thresholds - in a single column of a table or raster layer.</p>
<p>Think of a bit as a switch representing off and on states. A sequence of n bits can accommodate 2^n states, enabling the encoding of boolean responses, categorical cases, integers, or even floating-point values with limited precision. The resulting bitfield creates a ‘computational footprint’ that preserves the context needed for cross-workflow integration and downstream reuse.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the official version from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"bitfield"</span><span class="op">)</span></span></code></pre></div>
<p>Install the latest development version from GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"bitfloat/bitfield"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<div class="section level3">
<h3 id="tabular-data">Tabular Data<a class="anchor" aria-label="anchor" href="#tabular-data"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bitfloat/bitfield" class="external-link">bitfield</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example data with quality issues</span></span>
<span><span class="va">bf_tbl</span></span>
<span><span class="co">#&gt; # A tibble: 9 × 5</span></span>
<span><span class="co">#&gt;       x     y commodity yield year </span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;     &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1  25.3  59.5 soybean   11.2  2021 </span></span>
<span><span class="co">#&gt; 2  27.9  58.1 maize     12.0  &lt;NA&gt; </span></span>
<span><span class="co">#&gt; 3  27.8  57.8 soybean   13.2  2021r</span></span>
<span><span class="co">#&gt; 4  27    59.2 &lt;NA&gt;       4.43 2021 </span></span>
<span><span class="co">#&gt; 5 259   Inf   honey     13.0  2021 </span></span>
<span><span class="co">#&gt; 6  27.3  59.1 maize      8.55 2021 </span></span>
<span><span class="co">#&gt; 7  26.1  58.4 soybean   11.3  2021 </span></span>
<span><span class="co">#&gt; 8  26.5 NaN   maize     10.6  2021 </span></span>
<span><span class="co">#&gt; 9   0     0   soybean    9.01 2021</span></span></code></pre></div>
<p>Create a registry to capture metadata about your workflow:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bf_registry.html">bf_registry</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"data_quality"</span>,</span>
<span>                   description <span class="op">=</span> <span class="st">"Quality assessment for agricultural data"</span>,</span>
<span>                   template <span class="op">=</span> <span class="va">bf_tbl</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Test for missing values (1 bit)</span></span>
<span><span class="va">reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bf_map.html">bf_map</a></span><span class="op">(</span>protocol <span class="op">=</span> <span class="st">"na"</span>, data <span class="op">=</span> <span class="va">bf_tbl</span>, x <span class="op">=</span> <span class="va">commodity</span>, registry <span class="op">=</span> <span class="va">reg</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Encode yield values with half precision (16 bits)</span></span>
<span><span class="va">reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bf_map.html">bf_map</a></span><span class="op">(</span>protocol <span class="op">=</span> <span class="st">"numeric"</span>, data <span class="op">=</span> <span class="va">bf_tbl</span>, x <span class="op">=</span> <span class="va">yield</span>,</span>
<span>              format <span class="op">=</span> <span class="st">"half"</span>, registry <span class="op">=</span> <span class="va">reg</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the registry structure</span></span>
<span><span class="va">reg</span></span>
<span><span class="co">#&gt;   type  data.frame</span></span>
<span><span class="co">#&gt;   width 17</span></span>
<span><span class="co">#&gt;   flags 2  -|----------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   pos encoding  name    col</span></span>
<span><span class="co">#&gt;   1   0.0.1/0   na      commodity</span></span>
<span><span class="co">#&gt;   2   1.5.10/15 numeric yield</span></span></code></pre></div>
<p>Encode the flags into integer representation:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">field</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bf_encode.html">bf_encode</a></span><span class="op">(</span>registry <span class="op">=</span> <span class="va">reg</span><span class="op">)</span></span>
<span><span class="va">field</span></span>
<span><span class="co">#&gt; # A tibble: 9 × 1</span></span>
<span><span class="co">#&gt;   bf_int1</span></span>
<span><span class="co">#&gt;     &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1   18840</span></span>
<span><span class="co">#&gt; 2   18942</span></span>
<span><span class="co">#&gt; 3   19101</span></span>
<span><span class="co">#&gt; 4   83054</span></span>
<span><span class="co">#&gt; 5   19071</span></span>
<span><span class="co">#&gt; 6   18502</span></span>
<span><span class="co">#&gt; 7   18851</span></span>
<span><span class="co">#&gt; 8   18770</span></span>
<span><span class="co">#&gt; 9   18561</span></span></code></pre></div>
<p>Decode the bitfield in a downstream application:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">decoded</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bf_decode.html">bf_decode</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">field</span>, registry <span class="op">=</span> <span class="va">reg</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Returns a named list with decoded values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">decoded</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "na_commodity"  "numeric_yield"</span></span>
<span></span>
<span><span class="co"># Access individual flags</span></span>
<span><span class="va">decoded</span><span class="op">$</span><span class="va">na_commodity</span></span>
<span><span class="co">#&gt; [1] 0 0 0 1 0 0 0 0 0</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>original <span class="op">=</span> <span class="va">bf_tbl</span><span class="op">$</span><span class="va">yield</span>, decoded <span class="op">=</span> <span class="va">decoded</span><span class="op">$</span><span class="va">numeric_yield</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 9 × 2</span></span>
<span><span class="co">#&gt;   original decoded</span></span>
<span><span class="co">#&gt;      &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1    11.2    11.2 </span></span>
<span><span class="co">#&gt; 2    12.0    12.0 </span></span>
<span><span class="co">#&gt; 3    13.2    13.2 </span></span>
<span><span class="co">#&gt; 4     4.43    4.43</span></span>
<span><span class="co">#&gt; 5    13.0    13.0 </span></span>
<span><span class="co">#&gt; 6     8.55    8.55</span></span>
<span><span class="co">#&gt; 7    11.3    11.3 </span></span>
<span><span class="co">#&gt; 8    10.6    10.6 </span></span>
<span><span class="co">#&gt; 9     9.01    9.01</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="raster-data">Raster Data<a class="anchor" aria-label="anchor" href="#raster-data"></a>
</h3>
<p>The same workflow applies to raster data - just use a <code>SpatRaster</code> as the template:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create example raster</span></span>
<span><span class="va">bf_rst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>nrows <span class="op">=</span> <span class="fl">3</span>, ncols <span class="op">=</span> <span class="fl">3</span>, vals <span class="op">=</span> <span class="va">bf_tbl</span><span class="op">$</span><span class="va">commodity</span>, names <span class="op">=</span> <span class="st">"commodity"</span><span class="op">)</span></span>
<span><span class="va">bf_rst</span><span class="op">$</span><span class="va">yield</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>nrows <span class="op">=</span> <span class="fl">3</span>, ncols <span class="op">=</span> <span class="fl">3</span>, vals <span class="op">=</span> <span class="va">bf_tbl</span><span class="op">$</span><span class="va">yield</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create registry with raster template</span></span>
<span><span class="va">reg_rst</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bf_registry.html">bf_registry</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"raster_quality"</span>,</span>
<span>                       description <span class="op">=</span> <span class="st">"Quality flags for raster data"</span>,</span>
<span>                       template <span class="op">=</span> <span class="va">bf_rst</span><span class="op">)</span></span>
<span></span>
<span><span class="va">reg_rst</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bf_map.html">bf_map</a></span><span class="op">(</span>protocol <span class="op">=</span> <span class="st">"na"</span>, data <span class="op">=</span> <span class="va">bf_rst</span>, x <span class="op">=</span> <span class="va">commodity</span>, registry <span class="op">=</span> <span class="va">reg_rst</span><span class="op">)</span></span>
<span><span class="va">reg_rst</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bf_map.html">bf_map</a></span><span class="op">(</span>protocol <span class="op">=</span> <span class="st">"numeric"</span>, data <span class="op">=</span> <span class="va">bf_rst</span>, x <span class="op">=</span> <span class="va">yield</span>,</span>
<span>                  format <span class="op">=</span> <span class="st">"half"</span>, registry <span class="op">=</span> <span class="va">reg_rst</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Encode returns a SpatRaster</span></span>
<span><span class="va">field_rst</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bf_encode.html">bf_encode</a></span><span class="op">(</span>registry <span class="op">=</span> <span class="va">reg_rst</span><span class="op">)</span></span>
<span><span class="va">field_rst</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; size        : 3, 3, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 120, 60  (x, y)</span></span>
<span><span class="co">#&gt; extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (CRS84) (OGC:CRS84) </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; name        : bf_int1 </span></span>
<span><span class="co">#&gt; min value   :   18502 </span></span>
<span><span class="co">#&gt; max value   :   83054</span></span>
<span></span>
<span><span class="co"># Decode returns a multi-layer SpatRaster</span></span>
<span><span class="va">decoded_rst</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bf_decode.html">bf_decode</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">field_rst</span>, registry <span class="op">=</span> <span class="va">reg_rst</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">decoded_rst</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; size        : 3, 3, 2  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 120, 60  (x, y)</span></span>
<span><span class="co">#&gt; extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (CRS84) (OGC:CRS84) </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; names       : na_commodity, numeric_yield </span></span>
<span><span class="co">#&gt; min values  :            0,      4.429688 </span></span>
<span><span class="co">#&gt; max values  :            1,     13.226562</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="getting-help">Getting Help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h2>
<ul>
<li>Browse the <a href="https://bitfloat.github.io/bitfield/reference/index.html" class="external-link">function reference</a> for detailed documentation</li>
<li>Report bugs at <a href="https://github.com/bitfloat/bitfield/issues" class="external-link">github.com/bitfloat/bitfield/issues</a>
</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=bitfield" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/bitfloat/bitfield/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/bitfloat/bitfield/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing bitfield</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://orcid.org/0000-0002-2958-0796" class="external-link">Steffen Ehrmann</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-2958-0796" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://orcid.org/0000-0002-2958-0796" class="external-link">Steffen Ehrmann</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
